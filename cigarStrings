library(dplyr)
library(readr)
library(ggplot2)
library(viridis)

# data from bam to csv and coverage fractions scripts 
setwd("~/Documents/Analyses_2020/full-length")
all <- read.csv(file = "5y-merged-gencode-lengths.csv", header = TRUE, na.strings="#N/A")

# get accuracy for each read
all <- all %>% 
  mutate(MID=nbrM+nbrI+nbrD)
all <- all %>% 
  mutate(NMID=nbrM+nbrI+nbrD-NM)
# accuracy calculation  
all <- all %>% 
  mutate(accuracy=NMID/MID)

all <- all %>% 
  mutate(softclip=nbrS/readLength)

all <- all %>% 
  mutate(insertions=nbrI/readLength*100)

all <- all %>% 
  mutate(deletions=nbrD/readLength*100)
